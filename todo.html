<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- CSS only -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1" crossorigin="anonymous">
    <title>Document</title>
</head>

<body>

    <style>
        header {
            height: 200px;
            width: 100%;
        }

        

        .todo {
            margin-top: 100px;
        }

        .sup {
            margin-left: 5px;
        }
    </style>

    <header>
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-12 col-lg-12"><img src="banniere.png" width="100%" height="200px"></div>
            </div>
        </div>
    </header>


    <section class="todo">
        <div class="container">
            <div class="row align-items-center justify-content-center">
                <div class=" col-12 col-lg-4">
                    <input id="task" type="text"><button id="btn" class="addBtn">Add</button>
                </div>
                <div class="col-12 col-lg-4">
                    <ul id="resultat">

                    </ul>
                </div>
            </div>
        </div>
        </div>
    </section>

    <script>
        var btn = document.getElementById('btn');
        var listId
        var todotableau = localStorage.getItem('todolist');
        if (todotableau !== null) {
            let tab2 = JSON.parse(todotableau);
        var listId = tab2.length;
       // alert (listId)
        }
        else{
            var listId = 0;  
        }

        //Objet de génération de liste
        function toDo(whatToDo) {
            this.content = function(){
                var list = document.createElement("li");
            list.id = 'li' + listId++;
            var value = whatToDo;
            var text = document.createElement('span');
            text.innerHTML = value
            var btnSup = document.createElement("button");
            btnSup.innerHTML = "Supprimer";
            btnSup.classList = "sup";
            list.appendChild(text);
            text.appendChild(btnSup);
          resultat.appendChild(list);  
          btnSup.addEventListener("click", function () {
              resultat.removeChild(list)
                  
           
              
            });
            }
        }

       
        var resultat = document.getElementById('resultat');
        let todo = []
          // Génération initiale de la liste.
           var todotableau = localStorage.getItem('todolist');
        //    console.log(todotableau)
        if(todotableau !== null){
            // alert('Y a un tableau')
            let todotableauParsed = JSON.parse(todotableau);
            for(let u = 0; u <todotableauParsed.length ;u++ ){
                var element = new toDo(todotableauParsed[u])
                element.content();
            }
        }

          //Génération de la liste au clic.
        btn.addEventListener("click", function () {
            

            
            var list = document.createElement("li");
            list.id = 'li' + listId++;
            var value = document.getElementById("task").value;
            var text = document.createElement('span');
            text.innerHTML = value
            var btnSup = document.createElement("button");
            btnSup.innerHTML = "Supprimer";
            btnSup.classList = "sup";
            list.appendChild(text);
            text.appendChild(btnSup);
          resultat.appendChild(list);
          todo.push(value);
        //    localStorage.setItem
            

            task.value = ""
          
            localStorage.setItem('todolist', JSON.stringify(todo))
            


            // localStorage.getItem('todolist', JSON.parse(todo))
            


            btnSup.addEventListener("click", function () {
              resultat.removeChild(list)
                  
           
              
            });


        });
    </script>


</body>

</html>